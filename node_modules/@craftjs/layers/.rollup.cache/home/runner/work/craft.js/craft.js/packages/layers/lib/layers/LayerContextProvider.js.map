{"version":3,"file":"LayerContextProvider.js","sourceRoot":"","sources":["../../src/layers/LayerContextProvider.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,eAAe,CAAC;AAC1C,OAAO,EAAE,kBAAkB,EAAE,MAAM,gBAAgB,CAAC;AACpD,OAAO,KAAK,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,OAAO,CAAC;AAEtE,OAAO,EAAE,YAAY,EAAoB,MAAM,gBAAgB,CAAC;AAChE,OAAO,EAAE,SAAS,EAAE,MAAM,aAAa,CAAC;AAExC,OAAO,EAAE,oBAAoB,EAAE,MAAM,6BAA6B,CAAC;AACnE,OAAO,EAAE,mBAAmB,EAAE,MAAM,YAAY,CAAC;AAEjD,MAAM,CAAC,MAAM,oBAAoB,GAG5B,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE;IACrB,MAAM,QAAQ,GAAG,oBAAoB,EAAE,CAAC;IAExC,MAAM,EAAE,KAAK,EAAE,GAAG,UAAU,CAAC,mBAAmB,CAAC,CAAC;IAClD,MAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;IAC/B,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;IAEzB,MAAM,eAAe,GAAG,OAAO,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,qBAAqB,EAAE,EAAE;QACtE,QAAQ;KACT,CAAC,CAAC;IAEH,MAAM,UAAU,GAAG,OAAO,CACxB,GAAG,EAAE,CAAC,kBAAkB,CAAC,eAAe,CAAC,UAAU,CAAC,EACpD,CAAC,eAAe,CAAC,CAClB,CAAC;IAEF,SAAS,CAAC,GAAG,EAAE;QACb,eAAe,CAAC,QAAQ,EAAE,CAAC;QAE3B,OAAO,GAAG,EAAE;YACV,eAAe,CAAC,OAAO,EAAE,CAAC;QAC5B,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAEtB,MAAM,EAAE,MAAM,EAAE,GAAG,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QACvC,MAAM,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC;KAC1B,CAAC,CAAC,CAAC;IAEJ,IAAI,CAAC,MAAM,EAAE;QACX,OAAO,IAAI,CAAC;KACb;IAED,OAAO,CACL,oBAAC,YAAY,CAAC,QAAQ,IAAC,KAAK,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE;QACrD,oBAAC,SAAS,OAAG,CACS,CACzB,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import { useEditor } from '@craftjs/core';\nimport { wrapConnectorHooks } from '@craftjs/utils';\nimport React, { useMemo, useContext, useRef, useEffect } from 'react';\n\nimport { LayerContext, LayerContextType } from './LayerContext';\nimport { LayerNode } from './LayerNode';\n\nimport { useLayerEventHandler } from '../events/LayerEventContext';\nimport { LayerManagerContext } from '../manager';\n\nexport const LayerContextProvider: React.FC<Omit<\n  LayerContextType,\n  'connectors'\n>> = ({ id, depth }) => {\n  const handlers = useLayerEventHandler();\n\n  const { store } = useContext(LayerManagerContext);\n  const storeRef = useRef(store);\n  storeRef.current = store;\n\n  const connectorsUsage = useMemo(() => handlers.createConnectorsUsage(), [\n    handlers,\n  ]);\n\n  const connectors = useMemo(\n    () => wrapConnectorHooks(connectorsUsage.connectors),\n    [connectorsUsage]\n  );\n\n  useEffect(() => {\n    connectorsUsage.register();\n\n    return () => {\n      connectorsUsage.cleanup();\n    };\n  }, [connectorsUsage]);\n\n  const { exists } = useEditor((state) => ({\n    exists: !!state.nodes[id],\n  }));\n\n  if (!exists) {\n    return null;\n  }\n\n  return (\n    <LayerContext.Provider value={{ id, depth, connectors }}>\n      <LayerNode />\n    </LayerContext.Provider>\n  );\n};\n"]}